<script src="https://cdn.pubnub.com/sdk/javascript/pubnub.7.2.2.min.js"></script>

<style>
    /* --- CHAT BOX STYLES --- */
    #chat-container {
        position: fixed; right: -300px; top: 0;
        width: 300px; height: 100%;
        background: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(15px);
        border-left: 2px solid var(--text-color);
        transition: right 0.3s ease;
        display: flex; flex-direction: column;
        z-index: 1000;
    }
    #chat-container.open { right: 0; }
    #chat-messages { flex: 1; overflow-y: auto; padding: 15px; color: white; font-family: sans-serif; font-size: 14px; text-align: left; }
    #chat-input { padding: 15px; background: rgba(255,255,255,0.1); border: none; color: white; outline: none; }
    .chat-toggle { position: absolute; left: -50px; top: 20px; background: var(--text-color); color: var(--bg-color); padding: 10px; cursor: pointer; border-radius: 5px 0 0 5px; }
    .msg { margin-bottom: 8px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 4px; }
    .msg b { color: var(--accent); }
</style>

<div id="chat-container">
    <div class="chat-toggle" onclick="document.getElementById('chat-container').classList.toggle('open')">ðŸ’¬</div>
    <div id="chat-messages"></div>
    <input type="text" id="chat-input" placeholder="Press Enter to chat...">
</div>

<script>
    // PASTE YOUR KEYS HERE
    const pubnub = new PubNub({
        publishKey: "REPLACE_WITH_YOUR_PUBLISH_KEY",
        subscribeKey: "REPLACE_WITH_YOUR_SUBSCRIBE_KEY",
        userId: "Player_" + Math.floor(Math.random() * 9999)
    });

    // Subscribe to the game channel
    pubnub.subscribe({ channels: ['word-bomber-chat'] });

    // Listen for new messages
    pubnub.addListener({
        message: function(event) {
            const msgDiv = document.getElementById('chat-messages');
            const newMsg = document.createElement('div');
            newMsg.className = 'msg';
            newMsg.innerHTML = `<b>${event.publisher.substring(0,8)}:</b> ${event.message}`;
            msgDiv.appendChild(newMsg);
            msgDiv.scrollTop = msgDiv.scrollHeight;
        }
    });

    // Send message on Enter
    document.getElementById('chat-input').addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && e.target.value.trim() !== "") {
            pubnub.publish({
                channel: 'word-bomber-chat',
                message: e.target.value
            });
            e.target.value = "";
        }
    });
</script>
